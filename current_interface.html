
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† Mentor Autonomous AI System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 3em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.3em; opacity: 0.9; }
        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .status-card { background: rgba(255,255,255,0.95); border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .status-card h3 { color: #2c3e50; margin-bottom: 15px; font-size: 1.3em; }
        .metric { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .metric-value { font-weight: bold; color: #667eea; }
        .chat-container { display: flex; gap: 20px; height: 500px; }
        .chat-messages { flex: 1; background: white; border-radius: 15px; padding: 20px; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .chat-sidebar { width: 350px; background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .message { margin-bottom: 15px; padding: 15px; border-radius: 12px; }
        .user-message { background: #e3f2fd; margin-left: 30px; border-left: 4px solid #2196f3; }
        .agent-message { background: #f3e5f5; margin-right: 30px; border-left: 4px solid #9c27b0; }
        .system-message { background: #e8f5e8; text-align: center; font-style: italic; border-left: 4px solid #4caf50; }
        .autonomous-message { background: #fff3e0; border-left: 4px solid #ff9800; }
        .input-container { display: flex; gap: 15px; margin-top: 20px; }
        .message-input { flex: 1; padding: 15px; border: none; border-radius: 25px; font-size: 16px; outline: none; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .send-button { padding: 15px 30px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 16px; transition: transform 0.2s; }
        .send-button:hover { transform: translateY(-2px); }
        .agent-selector { margin-bottom: 20px; }
        .agent-selector select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        .autonomous-tasks { margin-top: 20px; }
        .task-item { background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 8px; font-size: 0.9em; border-left: 3px solid #667eea; }
        .agent-status { display: flex; align-items: center; margin-bottom: 8px; }
        .status-indicator { width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; }
        .status-active { background: #4CAF50; }
        .status-idle { background: #ff9800; }
        .status-offline { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† Mentor Autonomous AI System</h1>
            <p>–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ —Å–∞–º–æ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</p>
        </div>
        
        <div class="status-grid">
            <div class="status-card">
                <h3>üìä –°–∏—Å—Ç–µ–º–Ω—ã–µ –ú–µ—Ç—Ä–∏–∫–∏</h3>
                <div class="metric">
                    <span>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:</span>
                    <span class="metric-value" id="systemStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="metric">
                    <span>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤:</span>
                    <span class="metric-value" id="activeAgents">0</span>
                </div>
                <div class="metric">
                    <span>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á:</span>
                    <span class="metric-value" id="completedTasks">0</span>
                </div>
                <div class="metric">
                    <span>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:</span>
                    <span class="metric-value" id="uptime">0—Å</span>
                </div>
            </div>
            
            <div class="status-card">
                <h3>ü§ñ –°—Ç–∞—Ç—É—Å –ê–≥–µ–Ω—Ç–æ–≤</h3>
                <div id="agentStatusList">
                    <div class="agent-status">
                        <span class="status-indicator status-active"></span>
                        <span>–ó–∞–≥—Ä—É–∑–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤...</span>
                    </div>
                </div>
            </div>
            
            <div class="status-card">
                <h3>‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h3>
                <div class="metric">
                    <span>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:</span>
                    <span class="metric-value">< 0.1—Å</span>
                </div>
                <div class="metric">
                    <span>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:</span>
                    <span class="metric-value">–û–ø—Ç–∏–º–∞–ª—å–Ω–æ</span>
                </div>
                <div class="metric">
                    <span>–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å:</span>
                    <span class="metric-value">100%</span>
                </div>
            </div>
        </div>
        
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message system-message">
                    <strong>üöÄ –°–∏—Å—Ç–µ–º–∞:</strong> Mentor Autonomous AI System –∑–∞–ø—É—â–µ–Ω–∞! –í—Å–µ –∞–≥–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ –∏ –≥–æ—Ç–æ–≤—ã –∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é.
                </div>
            </div>
            
            <div class="chat-sidebar">
                <div class="agent-selector">
                    <label for="agentSelect"><strong>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞:</strong></label>
                    <select id="agentSelect">
                        <option value="">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä</option>
                        <option value="general_assistant">üß† –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ü–æ–º–æ—â–Ω–∏–∫</option>
                        <option value="code_developer">üíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ö–æ–¥–∞</option>
                        <option value="data_analyst">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫ –î–∞–Ω–Ω—ã—Ö</option>
                        <option value="project_manager">üìã –ú–µ–Ω–µ–¥–∂–µ—Ä –ü—Ä–æ–µ–∫—Ç–æ–≤</option>
                        <option value="designer">üé® –î–∏–∑–∞–π–Ω–µ—Ä</option>
                        <option value="qa_tester">üîç –¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫</option>
                    </select>
                </div>
                
                <div class="autonomous-tasks">
                    <h3>ü§ñ –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –ó–∞–¥–∞—á–∏</h3>
                    <div id="autonomousTasksList">
                        <div class="task-item">–ê–≥–µ–Ω—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –∑–∞–¥–∞—á–∏...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="input-container">
            <input type="text" id="messageInput" class="message-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º—É –∞–≥–µ–Ω—Ç—É..." />
            <button onclick="sendMessage()" class="send-button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <script>
        let ws = null;
        let userId = 'user_' + Math.random().toString(36).substr(2, 9);
        
        function connectWebSocket() {
            ws = new WebSocket(`ws://${window.location.host}/ws/${userId}`);
            
            ws.onopen = function() {
                console.log('WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ');
            };
            
            ws.onmessage = function(event) {
                const data = JSON.parse(event.data);
                addMessage(data.message, 'agent', data.agent, data.ai_used);
            };
            
            ws.onclose = function() {
                console.log('WebSocket –æ—Ç–∫–ª—é—á–µ–Ω, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
                setTimeout(connectWebSocket, 3000);
            };
        }
        
        function addMessage(message, type, agent = '', ai_used = false) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            if (type === 'user') {
                messageDiv.className = 'message user-message';
                messageDiv.innerHTML = `<strong>–í—ã:</strong> ${message}`;
            } else {
                messageDiv.className = ai_used ? 'message autonomous-message' : 'message agent-message';
                const badge = ai_used ? ' üß†' : '';
                messageDiv.innerHTML = `<strong>${agent}${badge}:</strong> ${message}`;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            const agentType = document.getElementById('agentSelect').value;
            
            if (message && ws) {
                addMessage(message, 'user');
                
                const payload = {
                    message: message,
                    agent_type: agentType || null,
                    user_id: userId
                };
                
                ws.send(JSON.stringify(payload));
                input.value = '';
            }
        }
        
        function updateStatus() {
            fetch('/api/system/status')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('systemStatus').textContent = data.system_status;
                    document.getElementById('activeAgents').textContent = data.active_agents;
                    document.getElementById('completedTasks').textContent = data.autonomous_tasks;
                    document.getElementById('uptime').textContent = data.uptime;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–≥–µ–Ω—Ç–æ–≤
                    const agentStatusList = document.getElementById('agentStatusList');
                    agentStatusList.innerHTML = '';
                    
                    if (data.agents) {
                        Object.values(data.agents).forEach(agent => {
                            const agentDiv = document.createElement('div');
                            agentDiv.className = 'agent-status';
                            agentDiv.innerHTML = `
                                <span class="status-indicator status-active"></span>
                                <span>${agent.name}: –ê–∫—Ç–∏–≤–µ–Ω</span>
                            `;
                            agentStatusList.appendChild(agentDiv);
                        });
                    }
                })
                .catch(error => console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error));
        }
        
        function updateAutonomousTasks() {
            fetch('/api/autonomous/tasks')
                .then(response => response.json())
                .then(data => {
                    const tasksList = document.getElementById('autonomousTasksList');
                    tasksList.innerHTML = '';
                    
                    if (data.tasks.length === 0) {
                        tasksList.innerHTML = '<div class="task-item">–ê–≥–µ–Ω—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∑–∞–¥–∞—á–∏...</div>';
                    } else {
                        data.tasks.slice(-5).forEach(task => {
                            const taskDiv = document.createElement('div');
                            taskDiv.className = 'task-item';
                            taskDiv.innerHTML = `<strong>${task.description.substring(0, 60)}...</strong><br><small>${task.assigned_to} | ${task.status}</small>`;
                            tasksList.appendChild(taskDiv);
                        });
                    }
                })
                .catch(error => console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á:', error));
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        connectWebSocket();
        updateStatus();
        updateAutonomousTasks();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        setInterval(updateStatus, 5000);
        setInterval(updateAutonomousTasks, 8000);
    </script>
</body>
</html>
    